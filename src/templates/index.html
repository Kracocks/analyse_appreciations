<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyse textes</title>

    <!-- Install JQuery -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

    <!-- Install bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <!-- Install plotly.js -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>

    <!-- Load dropzone-->
    {{ dropzone.load_css() }}
    {{ dropzone.style('border: 2px dashed #0087F7; border-radius : 20px; min-height: 15%; max-width: 25%') }}
</head>

<body>
    <div id="file-input">
        <!-- Selection de fichier -->
        <script>
            dropzone_message = ">>> Glissez-déposez ou cliquez pour sélectionner <<< <br><br>"
            temp = "{{ fichier_charge | safe }}" != "" ? "Fichier chargé : {{ fichier_charge | safe }}" : ""
            dropzone_message = dropzone_message + temp
        </script>

        <!-- affichage de la dropzone-->
        {{ dropzone.create(action='index') }}
        {{ dropzone.load_js() }}
        {{ dropzone.config(
            custom_options='addRemoveLinks: true, 
                            dictDefaultMessage: dropzone_message') }}

        <!-- Selection de fichier récent -->
        <form method="post" enctype="multipart/form-data" id="recent_file_form">
            <label for="recent_files_choice">Choisir un fichier récemment utilisé</label>
            <select name="recent_files_choice" id="recent_files_choice">
                <option value="">Aucun fichier choisi</option>
                {% for fichier_recent in fichiers_recents %}
                <option value="{{ fichier_recent }}">{{ fichier_recent }}</option>
                {% endfor %}
            </select>
        </form>
        <script src="{{url_for('static', filename='on_file_selected.js')}}"></script>
    </div>

    <!-- Tout les éléments qui seront affiché lorsqu'un fichier à été sélectionné comme le choix du modèle, le graphique et la bar de chargement -->
    <div id="graphique-zone">
        <!-- Selection de paramètres pour le graphique -->
        <form method="post" id="parametre_form">
            <label for="modeles_choice">Choisir un modele</label>
            <select name="modeles_choice" id="modeles_choice">
                {% for modele in modeles_disponibles %}
                <option value="{{ modele }}" {% if modele==modele_selectionne %}selected{% endif %}>{{ modele }} ; corrélation : {{ notes_ia[modele] }}</option>
                {% endfor %}
            </select>
        </form>
        <script src="{{url_for('static', filename='on_parametre_change.js')}}"></script>

        <!-- Zone du graphique -->
        <div class="chart" id="bargraph"></div>
        <p id="selected_text"></p>

        <!-- Zone de la bar de chargement -->
        <div class="progress" id="progress" style="width:50%; margin: 50px;">
            <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">
                <span class="progress-bar-label">0%</span>
            </div>
        </div>

        <!-- Script de la zone de chargement-->
        {% if fichier_charge != "" %}
        <script src="{{url_for('static', filename='load_graph.js')}}"></script>
        {% endif %}
    </div>

    <!-- Affichage de graphique-zone -->
    {% if fichier_charge != "" %}
    <script>
        graphique_zone = document.getElementById("graphique-zone")
        graphique_zone.style.display = "block"
    </script>
    {% else %}
    <script>
        graphique_zone = document.getElementById("graphique-zone")
        graphique_zone.style.display = "none"
    </script>
    {% endif %}
</body>

</html>